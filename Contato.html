<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title data-i18n="contact.headTitle">Contato — Gustavo</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="assets/css/Style.css" />
  <link rel="stylesheet" href="assets/css/Contato.css" />
</head>
<body>
  <header>
    <a href="index.html" class="logo">Gustavo</a>
    <nav>
      <a href="index.html" data-i18n="nav.home">Home</a>
      <a href="Projetos.html" data-i18n="nav.projects">Projetos</a>
      <a href="Curriculo.html" data-i18n="nav.resume">Currículo</a>
      <a href="index.html#education" data-i18n="nav.education">Education</a>
      <a href="index.html#experience" data-i18n="nav.experience">Experience</a>
      <a href="Contato.html" class="active" data-i18n="nav.contact">Contact</a>
    </nav>
    <button id="langToggle" class="lang-toggle-btn" type="button" aria-label="Switch language">EN</button>
  </header>

  <section id="contact" class="contact section">
    <h2 data-i18n="contact.title">Contato</h2>

    <article class="contact-box">
      <p class="contact-lead" data-i18n="contact.subtitle">
        Me envie uma mensagem e responderei o quanto antes.
      </p>

      <form id="contactForm"
            class="contact-form"
            action="https://formspree.io/f/mrbabyya"  
            method="POST"
            accept-charset="UTF-8"
            novalidate>

        <div class="contact-grid">
          <div class="field">
            <label for="name" data-i18n="contact.nameLabel">Nome</label>
            <input type="text" id="name" name="from_name"
                   placeholder="Seu nome" required minlength="2" autocomplete="name"
                   data-i18n-attr="placeholder:contact.namePh">
            <small class="error" data-i18n="contact.nameError">Informe seu nome (mín. 2 caracteres).</small>
          </div>

          <div class="field">
            <label for="email" data-i18n="contact.emailLabel">E-mail</label>
            <input type="email" id="email" name="email"
                   placeholder="seu@email.com" required autocomplete="email"
                   data-i18n-attr="placeholder:contact.emailPh">
            <small class="error" data-i18n="contact.emailError">Informe um e-mail válido.</small>
          </div>
        </div>

        <div class="field">
          <label for="message" data-i18n="contact.messageLabel">Mensagem</label>
          <textarea id="message" name="message" rows="6"
                    placeholder="Escreva sua mensagem..." required minlength="10"
                    data-i18n-attr="placeholder:contact.messagePh"></textarea>
          <small class="error" data-i18n="contact.messageError">Escreva ao menos 10 caracteres.</small>
        </div>

        <input type="hidden" name="_subject" value="Contato — Gustavo">
        <input type="text" name="_gotcha" style="display:none">

        <button type="submit" class="btn" id="sendBtn" data-i18n="contact.send">Enviar</button>
        <p class="form-status" id="formStatus" role="status" aria-live="polite"></p>
      </form>
    </article>
  </section>

  <script src="assets/js/Script.js" defer></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('contactForm');
      const statusEl = document.getElementById('formStatus');
      const btn = document.getElementById('sendBtn');

      const t = (key, fb) => {
        const lang = document.body.dataset.lang || 'pt';
        const dict = (window.__DICT__ && window.__DICT__[lang]) || {};
        return dict[key] || fb;
      };

      const showStatus = (msg, ok = true) => {
        statusEl.textContent = msg;
        statusEl.classList.toggle('ok', ok);
        statusEl.classList.toggle('err', !ok);
      };

      const validate = () => {
        let ok = true;
        form.querySelectorAll('.field').forEach(f => {
          const input = f.querySelector('input,textarea');
          const error = f.querySelector('.error');
          if (!input.checkValidity()) {
            error.style.display = 'block';
            ok = false;
          } else {
            error.style.display = 'none';
          }
        });
        return ok;
      };

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        if (!validate()) {
          showStatus(t('contact.validationFail', 'Confira os campos destacados.'), false);
          return;
        }

        btn.disabled = true;
        const original = btn.textContent;
        btn.textContent = t('contact.sending', 'Enviando...');

        try {
          const formData = new FormData(form);
          const resp = await fetch(form.action, {
            method: 'POST',
            body: formData,
            headers: { 'Accept': 'application/json' }
          });

          if (resp.ok) {
            showStatus(t('contact.success', 'Mensagem enviada com sucesso!'));
            form.reset();
          } else {
            const data = await resp.json().catch(() => ({}));
            const errMsg = (data && (data.error || data.message)) ||
              t('contact.error', 'Falha ao enviar. Tente novamente mais tarde.');
            showStatus(errMsg, false);
          }
        } catch (err) {
          console.error(err);
          showStatus(t('contact.error', 'Falha ao enviar. Tente novamente mais tarde.'), false);
        } finally {
          btn.disabled = false;
          btn.textContent = original;
        }
      });
    });
  </script>
</body>
</html>
